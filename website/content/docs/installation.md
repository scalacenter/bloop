+++
description = "How to install Bloop on your machine"
title = "Installation"
date = "2018-02-08T16:35:00+01:00"
draft = false
weight = 1
bref = "Here are all the instructions to install Bloop"
toc = true
+++

## Mac OS

Install with [Homebrew](https://brew.sh) via:

```sh
$ brew install scalacenter/bloop/bloop
```

The formula installs a property list (`plist`) that starts the Bloop server
automatically when you log onto your machine. This way, you don't have to
start it manually.

If you don't want the Bloop server to start automatically, you can disable it: 

```sh
$ brew services stop bloop
```

If you want to have it start automatically *again*, type:

```sh
$ brew services start bloop
```

Homebrew also automatically installs completions for zsh and Bash.

## Other platforms

Install bloop in other platforms (Windows, Unix, \*bsd) via our python script:

<pre><code class="language-sh">$ curl -L https://github.com/scalacenter/bloop/releases/download/v<span class="latest-version">1.0.0-M10</span>/install.py | python
</code></pre>

The installation script will also install:

 * completions for zsh and Bash
 * service file for systemd
 * desktop entry for freedesktop-compliant desktop environments

but you need to set them up manually.

### Shell completions

#### Zsh completions

Add the following to your `~/.zshrc`:

```sh
autoload -U compinit
fpath=($HOME/.bloop/zsh $fpath)
compinit
```

#### Bash completions

To get the command line completions with Bash, add the following to your `~/.bash_profile`:

```sh
. $HOME/.bloop/bash/bloop
```

### Automatic startup

<span class="label warning">Note</span> that you should choose only one of
the methods below (systemd or desktop entry). Systemd is the more robust one,
but we provide a desktop entry for people not using systemd.

#### Systemd

One way to run Bloop server automatically if you are using systemd is to
install the provided user service file:

```sh
$ mkdir -p $HOME/.config/systemd/user
$ cp $HOME/.bloop/systemd/bloop.service $HOME/.config/systemd/user/
$ systemctl --user enable bloop
```

This way, Bloop server will be started when you log in for the first time and
stopped when you exit your last session. It is also possible to start the
service right after boot and keep it running until the system shuts down.
Please refer to [this wiki page about user services in systemd]
(https://wiki.archlinux.org/index.php/Systemd/User) if you want some advanced
options.

You can also check the status, start and stop the service manually:

```
$ systemctl --user status bloop
$ systemctl --user start bloop
$ systemctl --user stop bloop
```

Logs can be viewed using:

```
$ journalctl --user-unit bloop
```

#### Desktop Entry

There is a `bloop.desktop` file which you can use as a simple shortcut or as
an autostart entry if your desktop environment complies with freedesktop.org
specification and you are not using (or don't want to use) systemd.

To let your desktop environment know about the shortcut (it will most likely
add an icon to your applications menu, depending on environment) you can do:

```sh
$ mkdir -p $HOME/.local/share/applications
$ cp $HOME/.bloop/xdg/bloop.desktop $HOME/.local/share/applications/
```

To add it to autostart:

```sh
$ mkdir -p $HOME/.config/autostart
$ cp $HOME/.bloop/xdg/bloop.desktop $HOME/.config/autostart/
```

## Generate configuration files for your project

The first step is to generate the configuration files for Bloop. We have
plugins which do this for sbt and Maven. We are working on integrations for
Bazel and Gradle.

This action needs to be performed whenever your build changes (for example,
if you add a library dependency or change a resource generated by the build).

Head to [Bloop configuration format]({{< ref "configuration-format.md" >}})
to learn more details about the format and how to generate it from other tools.

<span class="label warning">Note</span> that the configuration file contains
machine-dependent information (the path of every resolved jar), so you must
not check it into your version control system.

### sbt

The sbt plugin is available for both sbt `0.13` and `1.x`. To install it, add
the following to your `project/plugins.sbt`:


<pre><code class="language-scala hljs scala">addSbtPlugin(<span class="hljs-string">"ch.epfl.scala"</span> % <span class="hljs-string">"sbt-bloop"</span> % <span class="hljs-string">"<span class="latest-version">1.0.0-M10</span>"</span>)</code></pre>


Once sbt is configured, you can run `bloopInstall` to generate the Bloop configuration:

```sh
$ sbt bloopInstall
[info] Loading global plugins from /Users/martin/.sbt/1.0/plugins
(...)
[success] Generated '/my-project/.bloop/foo.json'.
[success] Generated '/my-project/.bloop/foo-test.json'.
```

Bloop has generated two configuration files, one for the main project and another one for the test project.
The configuration files contain the information of the sbt build at the moment of running `bloopInstall`.

#### Support for source dependencies

If you use source dependencies in sbt, add the following setting definition to your `build.sbt`:

```scala
bloopAggregateSourceDependencies in Global := true
```

<span class="label warning">Note</span> that `bloopAggregateSourceDependencies` has to be scoped globally.

### Maven

To generate Bloop's configuration using Maven, run (from your project directory):

<pre><code class="language-sh">$ mvn ch.epfl.scala:maven-bloop_2.12:<span class="latest-version">1.0.0-M10</span>:bloopInstall
</code></pre>

<span class="label warning">Useful</span> You can remove the version number from the mvn command to fetch the latest Bloop release from master.

### Start bloop

Before using the bloop client, you need to start the Bloop server. There is usually only one bloop server running in a machine.

You need to start the server manually if you installed Bloop by other means
than the Homebrew formula in Mac OS. You can run the server with the bloop CLI:

```sh
$ bloop server
```

Assuming that `bloop`, located in `$HOME/.bloop`, is in your `$PATH`. Otherwise, we suggest creating an alias for the bloop CLI.

Note that you can also install Bloop in [another installation directory](#install-bloop-in-a-different-bloop-folder).

After the server is started, run the CLI tool:

```sh
$ bloop about
       _____            __         ______           __
      / ___/_________ _/ /___ _   / ____/__  ____  / /____  _____
      \__ \/ ___/ __ `/ / __ `/  / /   / _ \/ __ \/ __/ _ \/ ___/
     ___/ / /__/ /_/ / / /_/ /  / /___/ /__/ / / / /_/ /__/ /
    /____/\___/\__,_/_/\__,_/   \____/\___/_/ /_/\__/\___/_/

    bloop-frontend is made with love at the Scala Center <3

    Bloop-frontend version    `1.0.0-M2+14-7134b34d`
    Zinc version     `1.0.0-X8+510-660ed3cb`
    Scala version    `2.12.4`

    It is maintained by Martin Duhem, Jorge Vicente Cantero.
```

### Verify installation

```sh
$ bloop projects
foo
foo-test
```

Running `bloop projects` should give you a list of all the projects that
bloop has detected in that configuration directory. If you get none, you can check which configuration directory is bloop loading the projects from with:

```sh
$ bloop projects --verbose
[D] Projects loaded from '/my-project/.bloop':
foo
foo-test
```

If you continue to get no projects, check the logs of the sbt plugin and use
the configuration directory that `sbt-bloop` wrote the configuration files to
(see the logs of `bloopInstall` in the previous section) as the argument of `--config-dir`.

## Use the CLI

Once the installation is ready, let's try everything with a first compile.

```sh
$ bloop compile foo
Compiling 2 Scala sources to '/my-project/foo/target/classes'...
Done compiling.
```

The `compile` command accepts several options that let you configure how compilation happens. To get more information, trigger the autocompletions or type:

```sh
$ bloop compile --help
```

Now let's test your project with:

```sh
$ bloop test foo
[success] A foo should bar
```

If you want to start modifying the test, enable file watching with `bloop
test -p foo -w`!


You can learn about the rest of Bloop commands by typing `bloop --help` or
reading the [Command Reference]({{< ref "commands-reference.md" >}}).

## Other installation options

### Install bloop in a different bloop folder

By default, the script installs bloop binaries in a `.bloop` directory in your
`$HOME` folder. You can change that with the `--dest` option:

```sh
$ ./install.py --dest ~/bin/bloop
```

The current instructions use the standard `$HOME/.bloop` configuration
directory. If you use install bloop elsewhere, take care to replace the code
snippets in this page with your installation directory.

<span class="label warning">Note</span> If you want to place the bloop server
in an independent directory than the bloop client, head to the docs of the
[bloop server]({{< ref "how-to-use-bloop.md" >}}).

### Install a development version

The installation script can also be used to install a development version of Bloop. The [installation
script]({{< githubrepo >}}) can be downloaded directly from our repository.

This installation script requires more information to install Bloop:

 - The exact version to install. We publish artifacts for every commit on `master`. Look at the CI
   logs to figure out the exact version number.
 - The SHA of the commit to use to get the Nailgun client. Look at which commit points our `nailgun`
   submodule at a given point in time to find that information.
 - Coursier's version to use. Look at `project/Dependencies.scala` to find the version number.

Pass this information to the installation script:

```sh
$ ./install.py -v $BLOOP_VERSION -n $NAILGUN_COMMIT -c $COURSIER_VERSION
```

<script type="text/javascript">
  
  $.get("https://cors-anywhere.herokuapp.com/repo1.maven.org/maven2/ch/epfl/scala/bloop-frontend_2.12/maven-metadata.xml", function(xml) {
  
  var versions = 
    xml.getElementsByTagName("metadata")[0]
       .getElementsByTagName("versioning")[0]
       .getElementsByTagName("versions")[0]
       .getElementsByTagName("version")

  var latest = null;
  for (var i = versions.length - 1; i >= 0; i--) {
    var text = versions[i].innerHTML;
    if(text.indexOf(".") != -1 ) {
      latest = text;
      break
    }
  }

  $(".latest-version").html(latest);

}, "xml")
</script>
