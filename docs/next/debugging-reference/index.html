<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Debugging Reference · Bloop</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Bloop allows [BSP][bsp] build clients to start a [DAP][dap] (Debugging"/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Debugging Reference · Bloop"/><meta property="og:type" content="website"/><meta property="og:url" content="https://scalacenter.github.io/bloop/"/><meta property="og:description" content="Bloop allows [BSP][bsp] build clients to start a [DAP][dap] (Debugging"/><meta property="og:image" content="https://scalacenter.github.io/bloop/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://scalacenter.github.io/bloop/img/docusaurus.png"/><link rel="shortcut icon" href="/bloop/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/mono-blue.min.css"/><link rel="alternate" type="application/atom+xml" href="https://scalacenter.github.io/bloop/blog/atom.xml" title="Bloop Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://scalacenter.github.io/bloop/blog/feed.xml" title="Bloop Blog RSS Feed"/><link rel="stylesheet" href="/bloop/css/code-block-buttons.css"/><script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/bloop/scripts/code-block-buttons.js"></script><script src="/bloop/js/scrollSpy.js"></script><link rel="stylesheet" href="/bloop/css/main.css"/><script src="/bloop/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/bloop/"><img class="logo" src="/bloop/img/impure-logo-bloop.svg" alt="Bloop"/><h2 class="headerTitleWithLogo">Bloop</h2></a><a href="/bloop/versions"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/bloop/setup" target="_self">Install</a></li><li class="siteNavGroupActive"><a href="/bloop/docs/next/what-is-bloop" target="_self">Docs</a></li><li class=""><a href="/bloop/blog/" target="_self">Blog</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/scalacenter/bloop" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>References</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">General</h3><ul class=""><li class="navListItem"><a class="navItem" href="/bloop/docs/next/what-is-bloop">What is Bloop</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/usage">Quickstart</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/integration">Integration Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Build Tools</h3><ul class=""><li class="navListItem"><a class="navItem" href="/bloop/docs/next/build-tools/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/build-tools/sbt">sbt</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/build-tools/maven">Maven</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/build-tools/gradle">Gradle</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/build-tools/mill">Mill</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">IDEs</h3><ul class=""><li class="navListItem"><a class="navItem" href="/bloop/docs/next/ides/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/ides/intellij">IntelliJ</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/ides/metals">Metals</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">References</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/bloop/docs/next/debugging-reference">Debugging Reference</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/performance-guide">Performance guide</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/cli-reference">CLI --help</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/server-reference">Build Server</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/launcher-reference">Built-in Launcher</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/configuration-format">JSON Configuration</a></li><li class="navListItem"><a class="navItem" href="/bloop/docs/next/contributing-guide">Contributing Guide</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/scalacenter/bloop/edit/master/docs/debugging-reference.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Debugging Reference</h1></header><article><div><span><p>Bloop allows <a href="https://github.com/scalacenter/bsp/blob/master/docs/bsp.md">BSP</a> build clients to start a <a href="https://microsoft.github.io/debug-adapter-protocol/">DAP</a> (Debugging
Adapter Protocol) session to run a project or its tests. The core of the
debugging implementation in Bloop relies on Microsoft's <a href="https://github.com/microsoft/java-debug/">java-debug</a>
library and it's exposed through <a href="https://microsoft.github.io/debug-adapter-protocol/">DAP</a> support in <a href="https://github.com/scalacenter/bsp/blob/master/docs/bsp.md">BSP</a>.</p>
<p>Debugging only works on JVMs that support <a href="https://docs.oracle.com/javase/7/docs/jdk/api/jpda/jdi/">JDI</a> (Java Debug Interface). JDI
is typically available in all JDKs. If you use a JRE, you cannot use
debugging. Run <code>bloop about</code> to know if the Java runtime you run bloop with
supports JDI.</p>
<p>Support for debugging is not yet fully worked out and it's gradually becoming
better with every release. We're actively looking for contributions in this
space so drop by our <a href="https://gitter.im/scalacenter/bloop">Gitter channel</a> to help out make it better.</p>
<h2><a class="anchor" aria-hidden="true" id="debugging-via-an-editor"></a><a href="#debugging-via-an-editor" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Debugging via an editor</h2>
<p>If you want to debug your code with Bloop via <em>an editor</em> such as VS Code,
vim, Sublime or emacs you can use <a href="https://scalameta.org/metals/">Metals</a>.</p>
<p>If you use <em>IntelliJ</em>, use the built-in debugger. This debugger is great for
debugging applications but less ideal to debug tests because the test
execution does not come from Bloop. There can be discrepancies between
Bloop's and IntelliJ's test runner but debugging tests generally works well.</p>
<h2><a class="anchor" aria-hidden="true" id="debugging-from-a-build-client"></a><a href="#debugging-from-a-build-client" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Debugging from a build client</h2>
<p>A client starts a DAP session in the server by sending a <code>debugSession/start</code>
BSP request. It is the responsibility of the client to stop the session that
this request starts.</p>
<h5><a class="anchor" aria-hidden="true" id="request"></a><a href="#request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Request:</h5>
<ul>
<li>method: <code>debugSession/start</code></li>
<li>params: <code>DebugSessionParams</code></li>
</ul>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">DebugSessionParams</span> </span>{
  <span class="hljs-comment">/** A sequence of build targets affected by the debugging action. */</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">targets</span></span>: <span class="hljs-type">List</span>[<span class="hljs-type">BuildTargetIdentifier</span>]

  <span class="hljs-comment">/** The kind of data to expect in the `data` field. Mandatory. */</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dataKind</span></span>: <span class="hljs-type">Option</span>[<span class="hljs-type">String</span>]

  <span class="hljs-comment">/** A language-agnostic JSON object interpreted by the server. Mandatory. */</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">data</span></span>: <span class="hljs-type">Option</span>[<span class="hljs-type">Json</span>]
}
</code></pre>
<p>The data field contains language-agnostic information about what action
should the server debug. Bloop supports only two data kinds:</p>
<ol>
<li><code>scala-main-class</code> when <code>data</code> contains <a href="https://github.com/scalacenter/bsp/blob/master/docs/bsp.md#scala-run-params"><code>ScalaRunParams</code></a>.</li>
<li><code>scala-test-suites</code> when <code>data</code> contains <a href="https://github.com/scalacenter/bsp/blob/master/docs/bsp.md#scala-test-params"><code>ScalaTestParams</code></a>.</li>
</ol>
<p>The <code>targets</code> field tells the server which build targets should be run or
tested with debugging enabled.</p>
<h4><a class="anchor" aria-hidden="true" id="concrete-example"></a><a href="#concrete-example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Concrete example</h4>
<p>If the build client passes a <code>ScalaRunParams</code> in the <code>data</code> object and its
corresponding data kind to the server, the server will run a target with
those parameters. Likewise for <code>ScalaTestParams</code>.</p>
<p>These build actions will produce notifications to the BSP client according to
the <a href="https://github.com/scalacenter/bsp/blob/master/docs/bsp.md">Build Server Protocol specification</a>. For example, the execution of
a test suite will produce <code>build/taskStart</code> and <code>build/taskFinish</code>
notifications containing a <code>TestReport</code>.</p>
<h5><a class="anchor" aria-hidden="true" id="response"></a><a href="#response" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Response:</h5>
<p>When the server has run the build action and finished debugging, it responds to the client:</p>
<ul>
<li>result: <code>DebugSessionConnection</code>, defined as follows</li>
<li>error: JSON-RPC code and message set in case JDI is not available or an exception happens during the request.</li>
</ul>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">DebugSessionConnection</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">uri</span></span>: <span class="hljs-type">String</span>
}
</code></pre>
<ul>
<li>The <code>uri</code> field is the address where the server is listening to DAP clients.</li>
</ul>
<p>Build clients can use this <code>uri</code> to:</p>
<ol>
<li>Talk to the server via the DAP protocol if they implement the <code>DAP</code> client.</li>
<li>Pass the <code>uri</code> to a tool that talks <code>DAP</code>, such as VS Code.</li>
<li>Connect to the <code>uri</code> but proxy every DAP communication from the BSP server
to a real <code>DAP</code> client and viceversa.</li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="limitations"></a><a href="#limitations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Limitations</h2>
<p>Here are the current limitations with the DAP implementation and debugging support in Bloop.</p>
<ul>
<li>BSP responses for <code>buildTarget/test</code> and <code>buildTarget/run</code> are currently not
sent to the client. This is a temporary limitation that will be lifted soon.</li>
<li>There is currently no support for <a href="https://microsoft.github.io/debug-adapter-protocol/specification#Requests_Attach">multi-step <code>launch</code> and <code>attach</code>
requests</a>.
Bloop will ignore the <code>noDebug</code> field in a <code>launch</code> request. A launch runs
an application with a debugger attached by default.</li>
<li>Bloop will use the JVM options from the build target when starting a
debugger. There is currently no way to allow the users to programmatically change them.</li>
<li>Bloop does not implement some DAP requests to obtain completions or
information about sources. If you want to support these, you can have your
build client run a proxy DAP server that lets Bloop take care of the
heavy-lifting and that only responds to these client requests.</li>
</ul>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/bloop/docs/next/ides/metals"><span class="arrow-prev">← </span><span>Metals</span></a><a class="docs-next button" href="/bloop/docs/next/performance-guide"><span>Performance guide</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#debugging-via-an-editor">Debugging via an editor</a></li><li><a href="#debugging-from-a-build-client">Debugging from a build client</a></li><li><a href="#limitations">Limitations</a></li></ul></nav></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'cf5bcb37b134346182da2be3f5e0a76b',
                indexName: 'bloop_scala',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["version:next"]}
              });
            </script></body></html>